(function(c){c.fn.tbForm=function(p){function v(d,a){return a instanceof Array?a.join(d):a}function g(d){return d.replace(/^\s+|\s+$/g,"")}__Get_Form_By_ID=function(d){var a="",b;for(b in tbForm_data2[d]){var f=tbForm_data2[d][b].t,c=tbForm_data2[d][b].v;switch(f){case "txt":a+=__ToForm_txt(f,c);break;case "txta":a+=__ToForm_txta(f,c);break;case "sel":a+=__ToForm_sel(f,c);break;case "rad":a+=__ToForm_rad(f,c);break;case "cbx":a+=__ToForm_cbx(f,c);break;case "hid":a+=__ToForm_hid(f,c);break;case "btn":a+=
__ToForm_btn(f,c,d);break;case "file":a+=__ToForm_file(f,c);break;case "head":a+=__ToForm_head(f,c);break;case "prgf":a+=__ToForm_prgf(f,c)}}return a='<input type="hidden" name="tbForm_key" value="'+d+'"><input type="hidden" name="tbForm_PN" value="'+n+'">'+a};__ToForm_prgf=function(d,a){var b,f;b=a.paragraf.split("\n");b=v("<br>",b);f="font-size: "+a.fontsize+"; text-align: "+a.align+"; padding: "+a.padding+";";1==a.fontweight&&(f+=" font-weight: bold;");1==a.fontstyle&&(f+=" font-style: italic;");
classe="";1==a.class_cbx&&(classe=a.class_val);classcn="";1==a.classcn_cbx&&(classcn=a.classcn);return tx='<div t="prgf" class="pr'+classcn+'"><div class="prgf'+classe+'" style="'+f+'">'+b+"</div></div>"};__ToForm_head=function(d,a){var b='<div class="hr"><b class="cp">'+a.cpt_val+'</b><span class="cw">X</span></div>';msg_OK=a.msg_OK;msg_ERR=a.msg_ERR;return b};__ToForm_file=function(d,a){var b,f="";1==a.label_cbx&&""!=a.label_val&&(f='<label met="">'+a.label_val+"</label>");b=1==a.multiple?' multiple="multiple""':
"";var c="";1==a.class_cbx&&(c=a.class_val);var e="";1==a.classcn_cbx&&(e=a.classcn);return'<div t="file" class="pr'+e+'">'+f+'<div class="div_file"><span class="btfile">'+a.bt_text+'</span><input class="'+c+'" type="file" name="'+a.name+'[]" value=""'+b+'></div><div class="div_selectfile"></div></div>'};__ToForm_hid=function(d,a){return'<input type="hidden" name="'+a.name+'" value="'+a.value_val+'">'};__ToForm_btn=function(d,a,b){d="";1==a.class_cbx&&(d=a.class_val);var f="";1==a.classcn_cbx&&(f=
a.classcn);d='<div t="btn" class="pr'+f+'"><input class="'+d+'" type="submit" name="submit" value="'+a.bt_text+'"></div>';1==a.captcha&&(d='<div t="capt" class="pr"><img src="http://tbform.ru/api/captcha.php?id='+b+"_"+n+"__"+(new Date).getTime()+'" width="130" height="40" style="vertical-align: middle;" alt=""/><input type="text" style="width:130px;vertical-align: middle;" need="1" name="tbForm_capcha"></div>'+d);return d};__ToForm_cbx=function(d,a){var b="";1==a.cpt_cbx&&""!=a.cpt_val&&(b='<label  met="" class="cpt">'+
a.cpt_val+"</label>");var f="";1==a.class_cbx&&(f=a.class_val);var c="";1==a.classcn_cbx&&(c=a.classcn);return'<div t="cbx" class="pr'+c+'">'+b+'<input  id="M_'+n+"_"+a.name+'" name="'+a.name+'" type="checkbox" '+(1==a.checked_onoff?' checked="checked"':"")+' value="'+a.label_val+'"><label for="M_'+n+"_"+a.name+'" class="'+f+'">'+a.label_val+"</label></div>"};__ToForm_rad=function(d,a){var b,c,e="";1==a.label_cbx&&""!=a.label_val&&(e='<label  met="" class="cpt">'+a.label_val+"</label>");var g="";
1==a.class_cbx&&(g=a.class_val);var k="";1==a.classcn_cbx&&(k=a.classcn);c="";if(""!=a.spisok){var l=a.spisok.split("\n"),m;for(m in l)b=a.activ_el==l[m]?' checked="checked"':"",c=c+'<input type="radio" id="M_'+n+"_"+m+""+a.name+'" name="'+a.name+'" value="'+l[m]+'" '+b+'><label for="M_'+n+"_"+m+""+a.name+'" class="'+g+'">'+l[m]+"</label>"}return tx='<div t="rad" class="pr'+k+'">'+e+'<div class="rad_block">'+c+"</div></div>"};__ToForm_sel=function(c,a){var b,f,e="";1==a.label_cbx&&""!=a.label_val&&
(e='<label  met="">'+a.label_val+"</label>");var g="";1==a.class_cbx&&(g=a.class_val);var k="";1==a.classcn_cbx&&(k=a.classcn);f="";if(""!=a.spisok){var l=a.spisok.split("\n"),m;for(m in l)b=a.activ_el==l[m]?' selected="selected"':"",f=f+'<option value="'+l[m]+'"'+b+">"+l[m]+"</option>"}return'<div t="sel" class="pr'+k+'">'+e+'<select class="'+g+'" name="'+a.name+'" >'+f+"</select></div>"};__ToForm_txta=function(c,a){var b="";1==a.label_cbx&&""!=a.label_val&&(b='<label  met="">'+a.label_val+"</label>");
var f="";1==a.placeholder_cbx&&""!=a.placeholder_val&&(f=a.placeholder_val);var e="";1==a.value_cbx&&(e=a.value_val);var g="";1==a.class_cbx&&(g=a.class_val);var k="";1==a.classcn_cbx&&(k=a.classcn);var l="";1==a.needs_cbx&&(l=' need="1"');var m="";1==a.readonly_cbx&&(m=' readonly="readonly"');return'<div t="txta" class="pr'+k+'">'+b+'<textarea class="'+g+'"'+l+' name="'+a.name+'" placeholder="'+f+'" '+m+" >"+e+"</textarea></div>"};__ToForm_txt=function(c,a){var b="";1==a.label_cbx&&""!=a.label_val&&
(b='<label  met="">'+a.label_val+"</label>");var f="";1==a.placeholder_cbx&&""!=a.placeholder_val&&(f=a.placeholder_val);var e="";1==a.value_cbx&&(e=a.value_val);var g="";1==a.class_cbx&&(g=a.class_val);var k="";1==a.classcn_cbx&&(k=a.classcn);var l="";1==a.needs_cbx&&(l=' need="1"');var m="";1==a.readonly_cbx&&(m=' readonly="readonly"');return'<div t="txt" class="pr'+k+'">'+b+'<input class="'+g+'"'+l+' type="text" type_f="'+a.type+'" name="'+a.name+'" placeholder="'+f+'" '+m+' value="'+e+'"></div>'};
c(document).height();0<c("div.tbForm_BG").length||c("body").append('<div class="tbForm_BG"></div>');var z={width:0,onClose:function(c){},onOpen:function(c){},onSend:function(c){}},e,A={},n=0;this.each(function(){p=p?c.extend(z,p):z;var d=(""+c(this).attr("data-tbForm")).split("-");if(0==tbForm_data2[d[1]]||"P"!=d[0]&&"M"!=d[0])return!0;var a=0,b;n+=1;"P"==d[0]?(a=1,b=c(this),b.html('<div><form enctype="multipart/form-data" action="http://tbform.ru/api/"  method="post" target="tbFormF_P_'+n+'">'+__Get_Form_By_ID(d[1])+
'<a style="color:#939393; position:absolute; right:10px; bottom:10px; text-decoration:none;" href="http://tbform.ru/?PodarokF='+d[1]+'" target="_blank">\u00a9tbForm.ru</a></form><div class="tbForm_wait">\u0421\u0435\u043a\u0443\u043d\u0434\u043e\u0447\u043a\u0443, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 ...</div><div class="tbForm_result"></div><iframe class="tbForm_iframe" id="tbFormF_P_'+n+'" name="tbFormF_P_'+n+'" src="" ></iframe></div>'),b.find("div.hr span.cw").css("display",
"none"),b.find("form").append('<input type="hidden" name="idFame" value="P_'+n+'"/>')):1!=A[d[1]]&&(a=A[d[1]]=1,c("body").append('<div class="tbForm" id="tbForm_M_'+d[1]+'"><div style="width:400px;  margin-top: 100px;"><form enctype="multipart/form-data" action="http://tbform.ru/api/"  method="post" target="tbFormF_M_'+d[1]+'">'+__Get_Form_By_ID(d[1])+'<a style="color:#939393; position:absolute; right:10px; bottom:10px; text-decoration:none;" href="http://tbform.ru/?PodarokF='+d[1]+'" target="_blank">\u00a9tbForm.ru</a></form><div class="tbForm_wait">\u0421\u0435\u043a\u0443\u043d\u0434\u043e\u0447\u043a\u0443, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 ...</div><div class="tbForm_result"></div><iframe class="tbForm_iframe" id=tbFormF_"M_'+
d[1]+'" name="tbFormF_M_'+d[1]+'" src="" ></iframe></div></div>'),b=c("body").find("div#tbForm_M_"+d[1]),b.find("form").append('<input type="hidden" name="idFame" value="M_'+d[1]+'"/>'));var f="",x="";if(1==a){b.find("form").append('<input type="hidden" name="tbForm_res" value=""/>');var y=(""+c(this).attr("data-dis")).split(";"),k;for(k in y){var l=y[k].split("=");"color"==g(l[0])&&(x=g(l[1]));"style"==g(l[0])&&(f=g(l[1]))}b.attr("style_disine",f);b.attr("color",x);b.find("input[type_f=datetime]").datetimepicker({format:"d.m.Y",
formatDate:"d.m.Y"});b.find("input[type_f=time]").datetimepicker({datepicker:!1,format:"H:i"});b.find("input[type_f=date]").datetimepicker({timepicker:!1,format:"d.m.Y",formatDate:"d.m.Y"});b.find("input[type_f=tel]").mask("+7 (999) 999 99 99");0!=p.width&&b.find("div").first().css("width",p.width+"px")}if("P"==d[0])for(k in f=(""+c(this).attr("data-def")).split(";"),f)f[k]=g(""+f[k]),""!=f[k]&&(e=f[k].split("="),b.find('input[type=text][name="'+g(e[0])+'"], textarea[name="'+g(e[0])+'"], select[name="'+
g(e[0])+'"], input[type=hidden][name="'+g(e[0])+'"] ').val(e[1]),b.find('input[type=radio][name="'+g(e[0])+'"]').prop("checked",!1),b.find('input[type=radio][name="'+g(e[0])+'"][value="'+e[1]+'"]').prop("checked",!0),e[1]="false"==e[1]?!1:!0,b.find('input[type=checkbox][name="'+g(e[0])+'"]').prop("checked",!1),b.find('input[type=checkbox][name="'+g(e[0])+'"]').prop("checked",e[1]));if("M"==d[0])var m=c(this),C="tbForm_M_"+d[1];if(1==a){var D=b.find("iframe"),E=b.find("input[type=file]"),F=b.find("input[type=submit]"),
G=b.find("form"),H=b.find("div[t=capt] img"),I=b.find("div.hr span.cw");k=b.find("form").height();b.find("div.tbForm_wait").css("height",k+"px");b.find("div.tbForm_wait").css("line-height",k-96-10+"px");b.find("div.tbForm_result").css("height",k+"px");k=b.find("form").width();b.find("div.tbForm_wait").css("width",k+"px");b.find("div.tbForm_result").css("width",k+"px");b.find('input[need="1"], textarea[need="1"]').attr("required","");"M"==d[0]&&(c(window).width(),c(window).height(),b.css("display",
"none"))}var h=function(){"M"==d[0]&&(this.btSF=m,this.idMF=C);1==a&&(this.status=0,this.frame=D,this.bt_submit=F,this.frm=G,this.bt_file=E,this.captcha=H,this.btCW=I,this.msg_OK=msg_OK,this.msg_ERR=msg_ERR,this.idF=d[1])},h=new h;"M"==d[0]&&h.btSF.click(function(a){c("body").addClass("tbForm_scroll_off");a=(""+c(this).attr("data-def")).split(";");for(var b in a)a[b]=g(""+a[b]),""!=a[b]&&(e=a[b].split("="),c("div#"+h.idMF).find('input[type=text][name="'+g(e[0])+'"], textarea[name="'+g(e[0])+'"], select[name="'+
g(e[0])+'"], input[type=hidden][name="'+g(e[0])+'"] ').val(e[1]),c("div#"+h.idMF).find('input[type=radio][name="'+g(e[0])+'"]').prop("checked",!1),c("div#"+h.idMF).find('input[type=radio][name="'+g(e[0])+'"][value="'+e[1]+'"]').prop("checked",!0),e[1]="false"==e[1]?!1:!0,c("div#"+h.idMF).find('input[type=checkbox][name="'+g(e[0])+'"]').prop("checked",!1),c("div#"+h.idMF).find('input[type=checkbox][name="'+g(e[0])+'"]').prop("checked",e[1]));c(".tbForm_BG").css("display","block");c("div#"+h.idMF).css("display",
"block");p.onOpen(h.idF)});if(1==a){h.btCW.click(function(a){c("body").removeClass("tbForm_scroll_off");c(".tbForm_BG").css("display","none");c("div#"+h.idMF).css("display","none");p.onClose(h.idF)});var r,w;h.bt_submit.click(function(a){r=0;b.find("input[need=1], textarea[need=1]").each(function(){if(""==c(this).val())return c(this).focus(),r=1,!1});b.find("input[type_f=email]").each(function(){var a=c(this).val(),b;if(b=""!=a)b=0==(new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i)).test(a);
if(b)return c(this).focus(),r=1,!1})});h.frm.submit(function(){if(1==r)return!1;h.status=1;b.find("form").css("display","none");b.find(".tbForm_wait").css("display","block")});h.frame.click(function(){if(1!=h.status)return!1;h.status=2;tx=b.find("input[name=tbForm_res]").val();w=1;e=tx.split("#tbForm#");"ok"==e[1]&&(b.find(".tbForm_result").html(v("<br>",h.msg_OK.split("\n"))),p.onSend(h.idF));"err"==e[1]&&(b.find(".tbForm_result").html(e[4]),"2"==e[2]&&(w=0));b.find(".tbForm_wait").css("display",
"none");b.find(".tbForm_result").css("display","block");h.captcha.click();b.find("[name=tbForm_capcha]").val("");setTimeout(function(){b.find("form").css("display","block");b.find(".tbForm_result").css("display","none");h.status=0;1==w&&"M"==d[0]&&h.btCW.click()},3E3)});h.frame.load(function(a,c,d){"error"==c&&b.find(".tbForm_result").html(v("<br>",h.msg_ERR.split("\n")))});var u;h.captcha.click(function(){t=h.captcha.attr("src");t=t.split("=");u=t[0]+"=";t=t[1].split("_");u=u+t[0]+"_"+t[1]+"__"+
(new Date).getTime();h.captcha.attr("src",u)});var B,q;h.bt_file.change(function(){q="";B=this.files;c.each(B,function(a,b){q=q+", "+b.name});q=q.slice(2);b.find("div.div_selectfile").text(q)})}})}})(jQuery);function tbForm_listener(c){if("http://tbform.ru"==c.origin){var p=c.data.split("#tbForm#");$('.tbForm form[target="tbFormF_'+p[3]+'"] input[name=tbForm_res]').val(c.data);$('.tbForm form[target="tbFormF_'+p[3]+'"]').parent().find("iframe").click()}}
window.addEventListener("message",tbForm_listener,!1);